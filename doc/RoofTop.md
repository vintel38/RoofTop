# Le projet RoofTop : Une application d'imagerie satellite et de Machine Learning au service de la lutte pour le climat


Dans cet article, je vous présente une solution simple et compréhensible que j'ai développée dans le cas du Copernicus Masters 2021 organisé par l'ESA. Ce hackathon promeut l'utilisation de l'imagerie satellite par l'émergence de projet à impact pour accentuer la lutte contre le réchauffement climatique. Si l'imagerie satellite ou l'intelligence artificielle ne vous parlent pas, pas de soucis, ils m'étaient également inconnus au début de l'année 2021 ! Ready ? Off we go !

<img src="https://github.com/vintel38/RoofTop/blob/master/doc/images/CM.png"  width="700" />

## La génèse du projet : se perdre sur les réseaux

Sans le covid, je n'aurais jamais participé à cette compétition. Double-diplômé en décembre 2020 en propulsion aérospatiale, la recherche d'emploi ne s'annonçait pas gagnée. Mais fin février 2021 pendant une discussion sur de la télédétection avec un collègue et ami de mon second master, il évoque la compétition [Copernicus Masters](https://copernicus-masters.com/). Ce hackathon m'a tout de suite intéressé comme il synthétisait et combinait parfaitement mes compétences en informatique, en Machine Learning (Computer Vision) sur lequel je travaillais secrètement depuis plus de 2 ans ainsi que mes aspirations entrepreneuriales. La pandémie du covid19 qui a bouleversé mes études m'a également poussé à remettre en cause mes projets de carrière professionnelle. En effet, j'ai senti durant cette période que quelque chose avait changé au fond de moi. J'avais dorénavant la conviction qu'il était possible d'améliorer la société en se servant simplement de la technologie dont nous disposions déjà et qu'il incombait aux ingénieurs de réaliser la mise en œuvre de ces changements sociétaux. 

<img src="https://github.com/vintel38/RoofTop/blob/master/doc/images/Capture.png"  width="700" />

Je traîne beaucoup sur Facebook et il a suffi d'un scroll et d'une vidéo de [Loopsider](https://www.facebook.com/Loopsider/videos/500691364579511/) pour que l'idée émerge. Dans cette vidéo, la chaîne présente une jeune entreprise bretonne qui s'est lancée, comme les Américains et les grecs le font depuis peu et beaucoup plus longtemps, dans la repeinte des toits de bâtiments en blanc pour refleter les rayons du soleil. Pour moi qui ai une formation avant tout d'énergéticien, la simplicité de cette solution était tout simplement déconcertante. Si vous ne voulez pas qu'un local se réchauffe, ne laissez pas la chaleur rentrer ! Je vous explique dans la partie suivante le principe thermique. Comme les toits sont souvent plats, ils font directement face au ciel et donc ils peuvent être observés par des satellites artificiels placés exactement d'où vient le problème, c'est-à-dire le rayonnement solaire. 

<img src="https://github.com/vintel38/RoofTop/blob/master/doc/images/chicago12_01.tif"  width="700" />
Imagerie aérienne très haute résolution de la périphérie de Chicago issue de INRIA Aerial Image Labeling Dataset

Ni une ni deux le projet naissait, j'allais détecter des toits sombres de bâtiments sur des images très hautes résolutions en utilisant des algorithmes de Machine Learning. Ce qu'il faut comprendre, c'est que ce concept donnait naissance non pas à un produit, mais à un projet. Je veux dire que ce projet ne se limite pas simplement à un système technique. Les tenants et aboutissants du processus de repeinte des toits offrent avec eux les clients potentiels ainsi que les avantages notoires vis-à-vis de ne rien faire (le fameux *shadow competiter*). Mais ça, je vous l'explique dans le prochain paragraphe. 

## Le principe physique et l'opportunité business

Le fait de repeindre les toits avec une peinture hautement réflective implique une baisse du réchauffement du bâtiment. Les transferts thermiques qui réchauffent les bâtiments sont divisés en 3 sous-domaines : la conduction à travers des matériaux solides, la convection qui s'accompagne d'un mouvement du fluide ou du gaz et le rayonnement qui n'a pas besoin de matière pour se propager. Dans le cas des îlots de chaleur qui sont une conséquence directe du réchauffement climatique en milieu urbain, c'est le rayonnement solaire qui est majoritairement en cause et qui apporte environ une puissance surfacique de 1000 W/m^2 en journée. Ce rayonnement lorsque qu'il impacte le matériau du bâtiment excite ses particules constitutives et la température du matériau augmente. La philosophie de cette solution est de s'attaquer à la base du problème. La couche de peinture hautement réflective va grandement augmenter la part de rayonnement solaire qui est réfléchie par la surface. Ce faisant, moins de rayonnement solaire est absorbé par les matériaux du toit ce qui signifie une hausse de température plus faible à l'intérieur. 

Toit avec isolation seule            |  Toit avec isolation repeinte
:-------------------------:|:-------------------------:
<img src="https://github.com/vintel38/RoofTop/blob/master/doc/images/heat.png" width="300" /> | <img src="https://github.com/vintel38/RoofTop/blob/master/doc/images/cool.png"  width="300" />
Images issues de la brochure de la société [CoolRoof](https://coolroof-france.com/wp-content/uploads/2021/05/plaquette_commerciale_en-1.pdf)   

L'intérêt de repeindre le toit en blanc réside donc dans la limitation de la hausse de température dans le bâtiment. Par conséquent, vous sollicitez moins la climatisation qui est connue pour être extrêmement énergivore. Cela signifie des économies drastiques en terme de consommation électrique du local commercial et donc en terme de trésorerie. Il est donc intéressant financièrement de faire repeindre son toit et cela participe même à la lutte contre le réchauffement climatique. De plus, les couches supérieures du toit réchauffent également l'atmosphère externe au bâtiment. Dans des zones artisanales et commerciales (ZAC), ce phénomène à lui seul peut expliquer une hausse de quelques degrés des températures locales. Ces zones étant souvent à proximité des centres urbains, elles participent à réchauffer l'atmosphère environnante et donc au phénomène d'îlot de chaleur urbain. Aussi, les institutions locales ont tout intérêt à promouvoir la repeinte de ces bâtiments pour améliorer les conditions de vie de leurs citoyens. 

<img src="https://github.com/vintel38/RoofTop/blob/master/doc/images/reserch_gate.png"  width="700" />
Représentation schématique de l'îlot de chaleur urbain (ICU) (Source : Morris et Simmonds, 2000)

Cependant, le mouvement est encore balbutiant en France. Le but de ce projet est donc d'accélérer le phénomène en produisant une base de données des bâtiments qui auraient intérêt à être repeint. Cette base de données peut être exploitée par les institutions si elles veulent organiser le processus de communication ou directement par une filiale de la société exploitant le pipeline RoofTop. Les sociétés contactées pourraient être incitées financièrement à réaliser l'opération au moyen de subventions délivrées par les institutions. 


## Le pipeline 

Le pipeline est "relativement" simple, compte-tenu du service proposé. Il est constitué de trois éléments qui utilisent tous des technologies distinctes pour fonctionner ensemble. Ci-dessous, vous pouvez voir un slide y faisant référence que j'ai présenté lors de la compétition Copernicus Masters. 

<img src="https://github.com/vintel38/RoofTop/blob/master/doc/prez/3.jpg"  width="700" />

- Les images satellites très hautes résolutions sont fournies directement par des sociétés d'imagerie spatiale prêt à l'emploi, c'est-à-dire ayant déjà subies toutes les corrections dues aux perturbations atmosphériques. Lors de l'entraînement, j'utilise la base de données Inria Aerial Image Labeling Dataset pour disposer d'une quantité d'imagerie VHR suffisante pour entraîner le réseau de neurones.
- Elles sont alors pré-traitées et mises en forme pour convenir à l'algorithme Mask RCNN suivant. Plus spécifiquement, la résolution des images est réduite à 0.6 m sol/pixel et elles sont découpées pour avoir une forme carrée de côté 1024 pixels. Toutes ces opérations sont réalisées avec la bibliothèque GDAL pour conserver les métadonnées géospatiales incluses dans les fichiers *.tif* proposés dans le dataset.
- Les données pré-traitées et séparées dans les classiques dossiers train/val/test sont alors envoyées à l'algorithme d'IA Mask RCNN. Je l'ai choisi, car il s'agit d'un des algo les plus performants dans le monde de la détection/segmentation d'instance. Ce sous-domaine de la vision informatique permet de détecter (identifier individuellement) des éléments constitutifs d'une image et d'associer à chaque élément les pixels qui le composent. Cela permettra par la suite d'estimer la surface du toit à repeindre. Grâce à la localisation du toit et aux données géospatiales incluses dans l'image, on est capable de remonter jusqu'au positionnement GPS du toit dans le référentiel WGS84 avec sa longitude et latitude.
- Chaque paire de *(longitude, latitude)* est envoyée au Google Maps API et convertie en adresse par l'intermédiaire d'un reverse geocoding. Les informations formatées renvoyées par l'API sont alors mises en forme et stockées dans une base de données du type PostGIS pour disposer d'un outil robuste et flexible. D'autres fonctionnalités de l'API peuvent être utilisées pour recevoir également les coordonnées mail et téléphone à contacter pour être mis en relation avec les propriétaires du bâtiment. 

L'entraînement est réalisé actuellement sur une session Google Colab avec un GPU de 12 GB de mémoire GRAM même si je songe à me doter d'un matériel plus performant qui me permettrait d'avoir des phases d'entraînement plus stables. Pour des raisons de confidentialité, le code associé au pipeline total avec la partie Google Colab et mise en forme de la base de données PostGIS ne sont pas partagés ainsi que les performances actuelles et futures du modèle. L'innovation contenue dans ce projet a été signalée à l'Institution Nationale de la Propriété Intelectuelle (INPI) via le format électronique de l'enveloppe e-Soleau. 

## Conclusion 

Au jour d'aujourd'hui où j'écris ces dernières lignes, j'ai eu l'occasion de tester le pipeline avec un petit dataset d'entraînement et les résultats sont extrêmement prometteurs. Même si certains bâtiments ne sont pas encore détectés sur des images de 0.37 km^2 , les plus importants sont correctement identifiés par l'IA et localisés précisément par l'API de Google Maps. Contrairement à ce qui est visible sur le slide du hackathon, la maturation du projet se situe aujourd'hui plus autour d'un TRL = 6 comme l'ensemble du pipeline commence à fonctionner de concert. Pour les plus data scientists d'entre vous, je continue d'annoter régulièrement des images pour booster les performances du pipeline en particulier la mAP et la mAR de l'algorithme Mask RCNN. 

Le hackathon Copernicus Masters 2021 doit rendre son verdict dans les prochaines semaines. De mon côté, je ne les ai pas vraiment attendus. Après avoir contacté divers partenaires de l'environnement de l'entreprenariat à Grenoble, le projet a d'ores et déjà retenu l'attention des responsables du programme French Tech Tremplin de l'incubateur French Tech in the Alps Grenoble. Cependant, je recherche actuellement des incubateurs pouvant accueillir le projet dans la région d'Aix-Marseille pour prendre en compte mes contraintes professionnelles actuelles. Mon souhait pour le futur est d'intégrer plus de solutions SaaS clés en main pour la lutte contre le réchauffement climatique à proposer aux acteurs du développement dans une démarche B2C pour se positionner comme un compromis entre le savoir-faire d'un Kermap et l'innovation d'un SpaceSense. 

Restez à l'écoute pour plus de projets DeepTech sur mon [LinkedIn](https://www.linkedin.com/in/vincent-arrigoni-8a80ba141/). Retrouvez-moi sur [UpWork](https://www.upwork.com/o/profiles/users/~01a4ac604eff45e6ae/) pour vos travaux de freelance en vision informatique.